# MyBitcoinFuture Organization AI Development Guidelines

**Version:** 4.0.0  
**Status:** Organization-Wide AI Development Standards  
**Scope:** Complete MyBitcoinFuture Ecosystem  
**Last Updated:** August 2025

## 🚨 CRITICAL: Multi-Repository Organization Structure

**⚠️ THIS IS NOT A MONOREPO OR SUBMODULES - THESE ARE SEPARATE REPOSITORIES**

### Organization Structure
```
MyBitcoinFuture Organization (GitHub Organization)
├── 📊 dashboard/              # Main application repository
├── 🌐 website/                # Landing page & documentation repository  
├── 🔌 plugins/                # Plugin ecosystem repository
├── 🚀 platform-manifests/     # Platform deployment repository
└── 📋 .github/                # Organization-level files (NOT a repo)
```

### Key Rules for Multi-Repo Development
1. **Each directory is a separate Git repository** with its own `.git` folder
2. **NEVER initialize git in the organization root** - each repo manages its own git
3. **Always specify which repository** you're working in
4. **Cross-repository dependencies** must be handled via package.json or imports
5. **The `.github` folder** contains organization-level documentation, not code

## 🔒 CRITICAL SAFETY RULES

### Cursor Agent Common Pain Points
**🚨 CRITICAL FOR CURSOR AGENTS: Common issues and solutions**

**Context Loss Issues:**
- **Problem**: Cursor agents forget which repository they're in
- **Solution**: Always check `pwd && git remote -v` before starting
- **Problem**: Agents lose track of file paths across repos
- **Solution**: Use absolute paths and specify repository context

**Import/Path Confusion:**
- **Problem**: Wrong import paths between repositories
- **Solution**: Always verify repository structure before imports
- **Problem**: Relative path confusion in multi-repo setup
- **Solution**: Use absolute paths or clear relative paths from repo root

**Git Confusion:**
- **Problem**: Agents try to initialize git in organization root
- **Solution**: Each repo manages its own git - never init in root
- **Problem**: Agents forget which repo they're committing to
- **Solution**: Always check `git status` and `git remote -v`

**Process Management:**
- **Problem**: Agents leave blocking processes running
- **Solution**: Always use timeouts and process cleanup
- **Problem**: Agents don't check for existing processes
- **Solution**: Always run process cleanup before starting servers

### File & Directory Deletion Prevention
**🚨 CRITICAL: NEVER DELETE FILES OR FOLDERS WITHOUT EXPLICIT USER PERMISSION**

**ABSOLUTE RULES:**
1. **NEVER delete any files unless user explicitly says "delete this specific file"**
2. **NEVER interpret "clean up" as "delete"** - always ask for clarification
3. **NEVER delete documentation files** - even if they seem "excessive"
4. **NEVER delete source code files** without explicit permission
5. **NEVER delete configuration files** without explicit permission
6. **When user says "clean up"** - ask: "Do you want me to organize/move files, or actually delete them?"

**Before ANY deletion (even if user says "delete"):**
1. **Ask for explicit confirmation**: "Are you sure you want me to delete [specific file]?"
2. **Verify the file/folder is safe to delete** - check if it's:
   - Generated/cache files (safe)
   - Temporary files (safe)
   - Actually unused code (verify first)
   - Part of a larger system (DANGEROUS)

3. **Check for dependencies** - search for imports/requires
4. **Confirm it's not moved elsewhere** - check if functionality exists elsewhere
5. **Use `git status`** to see what's tracked vs untracked
6. **When in doubt, ASK** - don't assume anything is safe to delete

**Safe deletions (ONLY with explicit permission):**
- `node_modules/` (regenerated by npm install)
- `.cache/` directories
- `*.log` files
- `dist/` or `build/` directories (regenerated)
- Temporary files with clear patterns

**NEVER DELETE (unless user explicitly says "delete this specific file"):**
- Source code files without verification
- Configuration files
- Documentation files (.md files)
- Test files
- Any `.js`, `.jsx`, `.ts`, `.tsx`, `.md` files
- Archive folders
- User-created content
- Any file the user might have created

**CRITICAL: When user says "clean up" or "organize":**
- **ALWAYS ask**: "Do you want me to organize/move files to a different location, or actually delete them?"
- **Default to organizing/moving** rather than deleting
- **Create archive folders** instead of deleting
- **Move files to .github/docs/archive/** if they seem like they should be archived

**Cursor-Specific File Safety:**
- **Always verify file exists** before editing: `ls -la path/to/file`
- **Check git status** before deleting: `git status path/to/file`
- **Use `git restore`** to undo changes: `git restore path/to/file`
- **Backup before major changes**: `cp file.js file.js.backup`
- **NEVER delete files without explicit user permission**
- **ALWAYS ask for confirmation** before any file deletion
- **When user says "clean up"** - ask if they want organization or deletion
- **Default to moving/organizing** rather than deleting

## 🎯 Essential AI Development Guidelines

### Context Management
**Always include in prompts:**
```
Context: MyBitcoinFuture Organization
- Current Repository: [specific repo name]
- Current File: [specific file path]
- Related Repositories: [list related repos]
- Task Scope: [what you're trying to accomplish]
```

### Repository-Specific Patterns

#### Dashboard Repository
- **Location**: `/dashboard/`
- **Purpose**: Main Bitcoin treasury management application
- **Key Files**: `api/`, `web/`, `cli/`, `desktop/`
- **Security**: JWT auth, xpub-only, no private keys

#### Website Repository  
- **Location**: `/website/`
- **Purpose**: Landing page and public documentation
- **Key Files**: `src/components/`, `public/`
- **Security**: Public-facing, no sensitive data

#### Plugins Repository
- **Location**: `/plugins/`
- **Purpose**: Plugin ecosystem and extensions
- **Key Files**: Plugin implementations, event system
- **Security**: Sandboxed execution, admin tokens

#### Platform-Manifests Repository
- **Location**: `/platform-manifests/`
- **Purpose**: Deployment configurations
- **Key Files**: Docker, Kubernetes, platform configs
- **Security**: Container security, secret management

### Bitcoin-Specific Guidelines
- **xpub-only architecture** - never handle private keys
- **Network validation** - always specify mainnet/testnet
- **Address validation** - validate all Bitcoin addresses
- **Transaction safety** - read-only operations by default
- **Mock data integration** - realistic but safe test data

### Security Guidelines
- **No hardcoded credentials** in documentation or code
- **Use placeholders** like `YOUR_JWT_TOKEN`, `YOUR_PASSWORD`
- **Environment variables** for all sensitive data
- **Input validation** on all user inputs
- **Audit logging** for all operations

### Command Execution Safety
**🚨 CRITICAL FOR CURSOR CHAT: NEVER run blocking commands without timeouts**

**FORBIDDEN COMMANDS:**
```bash
# ❌ DANGEROUS - Will block Cursor chat
npm start
node server.js
npm run dev
docker-compose up
kubectl apply
```

**REQUIRED SAFE PATTERNS:**
```bash
# ✅ SAFE - With timeout
timeout 30s npm start
timeout 60s npm run dev

# ✅ SAFE - Background with kill
npm start & sleep 10 && kill %1
npm run dev & sleep 15 && pkill -f "node"

# ✅ SAFE - Docker detach
docker-compose up -d

# ✅ SAFE - Health check approach
npm start & sleep 5 && curl -s --max-time 10 http://localhost:3000/health
```

**MANDATORY PROCESS CLEANUP:**
```bash
# Before starting any server, ALWAYS run:
pkill -f "node.*start" 2>/dev/null
pkill -f "npm.*dev" 2>/dev/null
pkill -f "docker.*compose" 2>/dev/null
sleep 2

# Verify no processes are running:
ps aux | grep -E "(node|npm|docker)" | grep -v grep
```

**VERSION CHECKING (when issues occur):**
```bash
node --version
npm --version
docker --version
git status
```

**Cursor Terminal Best Practices:**
- **Always check current directory**: `pwd` before running commands
- **Verify repository context**: `git remote -v` to confirm repo
- **Use explicit paths**: Don't rely on relative paths across repos
- **Check file existence**: `ls -la` before editing files
- **Verify git status**: `git status` before making changes

## 🛠️ Common Patterns

### Cross-Repository Imports
```javascript
// Dashboard importing shared utilities
const { securityUtils } = require('@mybitcoinfuture/shared');

// Website importing shared utilities
import { formatBitcoin } from '@mybitcoinfuture/shared';

// Plugins importing dashboard utilities
const { pluginUtils } = require('@mybitcoinfuture/dashboard');
```

### Error Handling
```javascript
try {
  // Operation
} catch (error) {
  logger.error('Operation failed:', error);
  return ApiResponse.error(res, error.message, 500);
}
```

### Bitcoin Validation
```javascript
const isValidXpub = (xpub) => {
  return /^xpub[a-km-zA-HJ-NP-Z1-9]{107}$/.test(xpub);
};
```

### API Response Pattern
```javascript
// Standard API response format
const ApiResponse = {
  success: (res, data) => res.json({ success: true, data, version: '1.0.0' }),
  error: (res, message, code = 500) => res.status(code).json({ 
    error: { code: 'ERROR', message }, 
    version: '1.0.0' 
  })
};
```

### Security Checklist (Quick Reference)
- [ ] **Input validation** - sanitize all inputs
- [ ] **Authentication** - verify JWT tokens
- [ ] **xpub validation** - Bitcoin addresses/xpubs only
- [ ] **Environment variables** - no hardcoded secrets
- [ ] **Audit logging** - log all operations
- [ ] **Error handling** - proper error responses

### Common AI Anti-Patterns to Avoid
- **Repository confusion** - Always specify which repo you're working in
- **Import path errors** - Verify repository structure before imports  
- **Context loss** - Include current state in every significant operation
- **Process hanging** - Always use timeouts for long-running commands
- **File path assumptions** - Always verify file existence before editing
- **Git confusion** - Check `git status` and `git remote -v` before commits
- **File deletion without permission** - NEVER delete files unless user explicitly says "delete this specific file"
- **Interpreting "clean up" as "delete"** - Always ask for clarification
- **Deleting documentation** - Never delete .md files or documentation folders

### Essential Testing Patterns
```javascript
// Test structure
describe('Feature', () => {
  beforeEach(() => {
    // Setup
  });
  
  it('should handle success case', async () => {
    // Arrange, Act, Assert
  });
  
  it('should handle error case', async () => {
    // Test error scenarios
  });
});
```

## 📚 Quick Reference

### Repository URLs
- **Dashboard**: `https://github.com/MyBitcoinFuture/dashboard`
- **Website**: `https://github.com/MyBitcoinFuture/website`
- **Plugins**: `https://github.com/MyBitcoinFuture/plugins`
- **Platform-Manifests**: `https://github.com/MyBitcoinFuture/platform-manifests`

### Key Commands
```bash
# Check which repo you're in
pwd && git remote -v

# Safe development
timeout 30s npm run dev

# Cross-repo work
cd ../other-repo && git status
```

### Quick Troubleshooting
```bash
# If commands seem to hang
Ctrl+C to interrupt
pkill -f "node" 2>/dev/null

# If file not found
ls -la path/to/file
find . -name "filename" 2>/dev/null

# If git issues
git status
git remote -v
git log --oneline -5

# If process issues
ps aux | grep -E "(node|npm)" | grep -v grep
lsof -i :3000  # Check port usage
```

---

**Built with ❤️ by the MyBitcoinFuture team**

*Empowering organizations to manage their Bitcoin treasury with confidence and security across all repositories.* 